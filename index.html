<!DOCTYPE html><html lang="en" class="scroll-smooth"><head><meta charset="UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>Grow a Garden Stock</title><link rel="icon" href="icon.svg" type="image/svg+xml" /><script src="https://cdn.tailwindcss.com"></script><style>body{font-family:'Nunito',sans-serif;background:linear-gradient(145deg,#e0e0e0,#fff);transition:background 0.4s ease}body.dark{background:linear-gradient(145deg,#1f2937,#111827)}.container{max-width:900px;margin:0 auto;padding:1.5rem}h1{font-weight:900;font-size:2.5rem;text-align:center;margin-bottom:1rem;color:#2c3e50;text-shadow:1px 1px 2px #fff,-1px -1px 2px #bbb}body.dark h1{color:#f3f4f6;text-shadow:1px 1px 2px #000,-1px -1px 2px #333}.card{background:#e0e0e0;box-shadow:5px 5px 10px #bebebe,-5px -5px 10px #fff;border-radius:1rem;padding:1rem;margin-bottom:1.5rem;transition:background 0.4s ease,box-shadow 0.4s ease}body.dark .card{background:#1e293b;box-shadow:inset 5px 5px 10px #111827,inset -5px -5px 10px #2c3e50}.category-header{font-weight:800;font-size:1.3rem;margin-bottom:1rem;color:#34495e}body.dark .category-header{color:#cbd5e1}.item-card{position:relative;background:#f0f0f0;box-shadow:3px 3px 6px #ccc,-3px -3px 6px #fff;border-radius:0.75rem;padding:0.75rem 1rem;margin-bottom:0.75rem;cursor:pointer;display:flex;align-items:center;justify-content:space-between;transition:box-shadow 0.3s ease,background 0.3s ease}.item-card:hover{box-shadow:6px 6px 12px #bbb,-6px -6px 12px #fff}body.dark .item-card{background:#2a3748;box-shadow:3px 3px 6px #1c2535,-3px -3px 6px #3a4a6a}body.dark .item-card:hover{box-shadow:6px 6px 12px #1c2535,-6px -6px 12px #3a4a6a}.item-text{font-weight:700;color:#2c3e50}body.dark .item-text{color:#e0e7ff}.quantity-badge{background:#8bc34a;color:#fff;font-weight:700;padding:0.2rem 0.5rem;border-radius:9999px;font-size:0.85rem;box-shadow:1px 1px 3px #6b8e23;user-select:none;min-width:2.2rem;text-align:center}body.dark .quantity-badge{background:#7bbf3f;box-shadow:1px 1px 3px #4c6b13}.dropdown-content{position:absolute;left:50%;transform:translateX(-50%) scale(0.95);top:110%;width:300px;background:#f9fafb;box-shadow:0 8px 20px rgba(0,0,0,0.15);border-radius:1rem;padding:1rem;color:#334155;font-size:0.9rem;opacity:0;visibility:hidden;pointer-events:none;transition:opacity 0.25s ease,transform 0.25s ease,visibility 0.25s;z-index:50;user-select:text}body.dark .dropdown-content{background:#111827;color:#cbd5e1;box-shadow:0 8px 20px rgba(0,0,0,0.7)}.dropdown-content.show{opacity:1;visibility:visible;pointer-events:auto;transform:translateX(-50%) scale(1)}.loading-container{display:flex;justify-content:center;gap:10px;margin:2rem 0}.cube{width:14px;height:14px;background:#4ade80;border-radius:0.25rem;animation:cubeScale 1.2s infinite ease-in-out}.cube:nth-child(2){animation-delay:0.2s}.cube:nth-child(3){animation-delay:0.4s}@keyframes cubeScale{0%,100%{transform:scale(1);opacity:1}50%{transform:scale(1.6);opacity:0.5}}.settings-btn{position:fixed;top:1rem;right:1rem;background:#e0e0e0;border-radius:9999px;padding:0.5rem 1rem;font-weight:700;box-shadow:3px 3px 6px #bebebe,-3px -3px 6px #fff;cursor:pointer;transition:background 0.3s ease,box-shadow 0.3s ease;user-select:none;z-index:999}.settings-btn:hover{background:#c7d5e0}body.dark .settings-btn{background:#1e293b;box-shadow:inset 3px 3px 6px #111827,inset -3px -3px 6px #2c3e50}body.dark .settings-btn:hover{background:#334155}select{border-radius:0.5rem;border:1.5px solid #94a3b8;padding:0.25rem 0.75rem;background:#f0f0f0;color:#334155;font-weight:600;box-shadow:2px 2px 5px #ccc,-2px -2px 5px #fff;transition:background 0.3s ease,border-color 0.3s ease;cursor:pointer}body.dark select{background:#2a3748;color:#cbd5e1;border-color:#475569;box-shadow:inset 2px 2px 5px #1b2736,inset -2px -2px 5px #3b4a6c}select:focus{outline:none;border-color:#4ade80;box-shadow:0 0 8px #4ade80}@media (max-width:640px){.dropdown-content{width:90vw;left:50%;transform:translateX(-50%) scale(1)}}</style></head><body class="transition-colors duration-300"><button class="settings-btn" aria-label="Toggle light/dark mode">Toggle Mode</button><div class="container"><h1>ü™¥ Grow a Garden Stock</h1><div class="flex flex-wrap justify-center gap-4 mb-6"><label class="inline-flex items-center gap-2 cursor-pointer select-none"><input type="checkbox" id="seeds" checked class="form-checkbox h-5 w-5 text-green-500" /><span class="font-semibold text-gray-700 dark:text-gray-300">Seeds</span></label><label class="inline-flex items-center gap-2 cursor-pointer select-none"><input type="checkbox" id="gear" checked class="form-checkbox h-5 w-5 text-green-500" /><span class="font-semibold text-gray-700 dark:text-gray-300">Gear</span></label><label class="inline-flex items-center gap-2 cursor-pointer select-none"><input type="checkbox" id="eggs" checked class="form-checkbox h-5 w-5 text-green-500" /><span class="font-semibold text-gray-700 dark:text-gray-300">Eggs</span></label><label class="inline-flex items-center gap-2 cursor-pointer select-none"><input type="checkbox" id="cosmetic" checked class="form-checkbox h-5 w-5 text-green-500" /><span class="font-semibold text-gray-700 dark:text-gray-300">Cosmetics</span></label></div><div id="output" aria-live="polite" aria-busy="false"></div><div id="loading" class="loading-container" aria-hidden="true" role="status" aria-live="assertive"><div class="cube"></div><div class="cube"></div><div class="cube"></div></div><div id="errorMsg" class="text-red-600 font-bold mt-6 text-center hidden" role="alert"></div></div><script>(()=>{const e="https://api.joshlei.com/v2/growagarden",t=document.getElementById("output"),n=document.getElementById("loading"),o=document.getElementById("errorMsg"),r=document.querySelector(".settings-btn"),a="dark";let d=null;function c(e){e?document.body.classList.add(a):document.body.classList.remove(a)}function s(e){localStorage.setItem("darkMode",e?"1":"0")}function i(){const e=localStorage.getItem("darkMode");if("1"===e)return!0;if("0"===e)return!1;return window.matchMedia("(prefers-color-scheme: dark)").matches}r.addEventListener("click",()=>{const e=document.body.classList.contains(a);c(!e),s(!e)}),c(i());function l(e){return`${e.toLocaleString()} ‚çü`}function u(e){const t=document.createElement("div");t.className="item-card",t.tabIndex=0,t.setAttribute("role","button"),t.setAttribute("aria-expanded","false"),t.setAttribute("aria-haspopup","true"),t.setAttribute("aria-controls",`details-${e.item_id}`);const n=document.createElement("div");n.className="flex items-center gap-3";const o=document.createElement("img");return o.src=e.icon,o.alt=`${e.display_name} icon`,o.className="w-10 h-10 rounded-md object-contain drop-shadow-md",n.appendChild(o),const d=document.createElement("div");d.className="flex flex-col";const c=document.createElement("span");c.textContent=e.display_name,c.className="item-text";const s=document.createElement("span");return s.className="quantity-badge",s.textContent=l(e.quantity),d.appendChild(c),d.appendChild(s),n.appendChild(d),t.appendChild(n),const f=document.createElement("div");f.className="dropdown-content",f.id=`details-${e.item_id}`,f.setAttribute("role","region"),f.setAttribute("aria-live","polite"),f.style.pointerEvents="auto",f.innerHTML=`<p><strong>Start:</strong> ${new Date(e.Date_Start).toLocaleString()}</p><p><strong>End:</strong> ${new Date(e.Date_End).toLocaleString()}</p><p><strong>Item ID:</strong> ${e.item_id}</p>`,t.appendChild(f),t.addEventListener("click",t=>{t.stopPropagation();const n="true"===t.currentTarget.getAttribute("aria-expanded");f.classList.contains("show")&&closeOpenDropdown(),n||(f.classList.add("show"),t.currentTarget.setAttribute("aria-expanded","true"),openDropdown={card:t.currentTarget,dropdown:f})}),t.addEventListener("keydown",t=>{"Enter"!==t.key&&" "!==t.key||t.preventDefault()&&t.currentTarget.click()}),t}function closeOpenDropdown(){openDropdown&&(openDropdown.dropdown.classList.remove("show"),openDropdown.card.setAttribute("aria-expanded","false"),openDropdown=null)}function showLoading(e){n.setAttribute("aria-hidden",e?"false":"true"),t.setAttribute("aria-busy",e?"true":"false"),n.style.display=e?"flex":"none"}function showError(e){o.textContent=e,o.classList.toggle("hidden",!e)}async function fetchData(){showLoading(!0),showError(""),closeOpenDropdown();try{const[e,t]=await Promise.all([fetch(`${API_BASE}/stock`),fetch(`${API_BASE}/weather`)]);if(!e.ok)throw new Error(`Stock API error: ${e.status}`);if(!t.ok)throw new Error(`Weather API error: ${t.status}`);const n=await e.json(),o=await t.json();renderData(n,o)}catch(e){showError("Error fetching data. No internet or rate limit reached, please try again later."),console.error(e),t.innerHTML=""}finally{showLoading(!1)}}function renderData(e,t){t.innerHTML="";const n=t.weather?.find(e=>e.active)||null;if(n){const o=document.createElement("div");o.className="card mb-6 flex items-center gap-4 justify-center text-center",o.innerHTML=`<img src="${n.icon}" alt="${n.weather_name}" class="w-16 h-16" /><div><h2 class="text-xl font-bold">${n.weather_name}</h2><p class="text-gray-600 dark:text-gray-400">Duration: ${Math.floor(n.duration/60)} min</p></div>`,t.appendChild(o)}const o=document.getElementById("seeds").checked,a=document.getElementById("gear").checked,d=document.getElementById("eggs").checked,s=document.getElementById("cosmetic").checked,c=[{key:"seed_stock",label:"Seeds",show:o},{key:"gear_stock",label:"Gear",show:a},{key:"egg_stock",label:"Eggs",show:d},{key:"cosmetic_stock",label:"Cosmetics",show:s}];c.forEach(({key:e,label:t,show:n})=>{if(!n||!e)return;const o=document.createElement("div");o.className="card",o.innerHTML=`<div class="category-header">${t}</div>`,e.forEach(t=>{const n=u(t);o.appendChild(n)}),t.appendChild(o)})}fetchData(),["seeds","gear","eggs","cosmetic"].forEach(e=>{document.getElementById(e).addEventListener("change",()=>fetchData())});var openDropdown=null;})();
</script></body></html>
