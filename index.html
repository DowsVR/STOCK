<!DOCTYPE html>
<html>
<head>
  <title>Grow a Garden Stock</title>
  <style>
    body { font-family: sans-serif; padding:20px; }
    .category { margin:20px 0; }
    .item { padding:4px; }
    .new { background: #d1ffd1; }
  </style>
</head>
<body>
  <h1>ðŸª´ Grow a Garden Stock</h1>
  <div><label><input type="checkbox" id="seeds" checked> Seeds</label>
        <label><input type="checkbox" id="gear" checked> Gear</label>
        <label><input type="checkbox" id="eggs" checked> Eggs</label></div>
  <div id="output"></div>

  <script>
    let prev = { seeds: [], gear: [], eggs: [] };

    async function fetchStock() {
      const res = await fetch('https://growagarden-stock-live.vercel.app/api/stock');
      const data = await res.json();

      const out = document.getElementById('output');
      out.innerHTML = '';

      ['seeds','gear','eggs'].forEach(type => {
        if (!document.getElementById(type).checked) return;
        const div = document.createElement('div');
        div.className = 'category';
        div.innerHTML = `<h3>${type.charAt(0).toUpperCase()+type.slice(1)}</h3>`;
        data[type].forEach(item => {
          const isNew = !prev[type].includes(item);
          const el = document.createElement('div');
          el.textContent = item;
          if (isNew) { el.classList.add('new'); notify(item); }
          div.appendChild(el);
        });
        prev[type] = data[type];
        out.appendChild(div);
      });
    }

    function notify(item) {
      if (Notification.permission==='granted') {
        new Notification('New stock!', { body: item });
      }
    }

    if (Notification.permission !== 'granted') {
      Notification.requestPermission();
    }

    fetchStock();
    setInterval(fetchStock, 10000);
  </script>
</body>
</html>
